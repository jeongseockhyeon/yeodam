<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>여행 상품 등록</title>
    <link rel="stylesheet" href="/css/tourAdd.css">
    <link rel="stylesheet" href="/css/categoryCheckBox.css">
    <style>
        #previewContainer {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }
        #previewContainer img {
            width: 150px;
            height: 150px;
            object-fit: cover;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
    </style>
    <script src="../../static/js/getTourDetail.js"></script>
</head>
<body>
<div class="container">
    <!-- 왼쪽 메뉴 -->
    <div class="sidebar">
        <div class="menu-button active" data-tab="intro" onclick="showTab('intro')">상품 소개</div>
        <div class="menu-button" data-tab="info" onclick="showTab('info')">필수 정보</div>
        <div class="menu-button" data-tab="photo" onclick="showTab('photo')">상품 사진</div>
    </div>

    <!-- 오른쪽 내용 -->
    <div class="content">
        <form id="tourItemForm">
            <!-- 상품 소개 -->
            <div id="intro" class="tab active-tab">
                <h2>상품 소개</h2>

                <label for="tourName">여행 상품명</label>
                <input type="text" id="tourName" name="tourName" required>

                <label for="tourDesc">여행 설명</label>
                <textarea id="tourDesc" name="tourDesc" rows="4" required></textarea>
            </div>

            <!-- 필수 정보 -->
            <div id="info" class="tab">
                <h2>필수 정보</h2>
                <label for="tourPeriod">여행 기간</label>
                <input type="text" id="tourPeriod" name="tourPeriod" required>

                <label for="tourRegion">여행 지역</label>
                <input type="text" id="tourRegion" name="tourRegion" required>

                <label for="maximum">최대 인원수</label>
                <input type="number" id="maximum" name="maximum" required>

                <label for="tourPrice">여행 가격</label>
                <input type="number" id="tourPrice" name="tourPrice" required>

                <div id="categoryCheckBox">
                    <h3>카테고리 선택</h3>
                </div>
            </div>

            <!-- 상품 사진 -->
            <div id="photo" class="tab">
                <h2>상품 사진</h2>
                <label>이미지 업로드</label><br>
                <input type="file" name="images" id="tourImages" accept="image/*" multiple>
                <p>* 최대 n장 업로드 가능</p>
                <!-- 미리보기 영역 -->
                <div id="previewContainer"></div>
            </div>

            <!-- 버튼 -->
            <button type="button" id="submitBtn">저장</button>
            <button type="button" onclick="alert('임시 저장 기능 추가')">임시 저장</button>
            <a href="/item/manage">상품 관리로 이동</a> <!-- 추후 상품 관리 페이지 생성 시 연결 -->
        </form>
    </div>
</div>
<script src="/js/validationFormData.js"></script>
<script src="/js/getCategory.js"></script>
<script src="/js/submitTour.js"></script>
<script src="/js/showTabs.js"></script>
<script>
    const tourImagesInput = document.getElementById('tourImages');
    const previewContainer = document.getElementById('previewContainer');
    let selectedImages = []; // 업로드된 파일 배열

    tourImagesInput.addEventListener('change', () => {
        // 새로운 파일 추가
        const files = Array.from(tourImagesInput.files);

        // 기존 이미지 + 새로 선택된 이미지 처리
        selectedImages = [...selectedImages, ...files];

        // 중복 제거
        const uniqueFiles = Array.from(new Set(selectedImages.map(file => file.name)))
            .map(name => selectedImages.find(file => file.name === name));

        selectedImages = uniqueFiles;

        // 미리보기 갱신
        updatePreview();
    });

    function updatePreview() {
        previewContainer.innerHTML = ''; // 기존 미리보기 초기화

        selectedImages.forEach(file => {
            const reader = new FileReader();
            reader.onload = () => {
                const img = document.createElement('img');
                img.src = reader.result;
                previewContainer.appendChild(img);
            };
            reader.readAsDataURL(file);
        });
    }
</script>
</body>
</html>
